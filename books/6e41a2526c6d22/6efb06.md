---
title: "2章"
free: false
---

## 基本制御

**loop**
  - 無限ループ
  - `break`で中断

```Rust
fn main() {
    let mut x = 0;
    loop {
        x += 1;
        if x == 42 {
            break;
        }
    }
    println!("{}", x);
}
```

- `loop`から値を返すこともできる
```Rust
fn main() {
    let mut x = 0;
    let v = loop {
        x += 1;
        if x == 13 {
            break "13 を発見";
        }
    };
    println!("loop の戻り値: {}", v);
}
```


**while**

```Rust
fn main() {
    let mut x = 0;
    while x != 42 {
        x += 1;
    }
}
```

**for**

Rustの`for`ループはイテレータとして表される式を反復処理する
- 配列の要素をデータ構造の要素を順に操作していく繰り返しの処理を行う構文

- `.. `演算子は、開始番号から終了番号の手前までの数値を生成するイテレータを作成
- `..= `演算子は、開始番号から終了番号までの数値を生成するイテレータを作成

```Rust
fn main() {
    for x in 0..5 {
        println!("{}", x);
    }

    for x in 0..=5 {
        println!("{}", x);
    }
}
```

**match**

- `switch`構文的な
- 複数パターンで条件作れる
- マッチしたパターンを変数にバインドもできる
- `match`から値を返すことはできる

```Rust
fn main() {
    let x = 42;

    match x {
        0 => {
            println!("found zero");
        }
        // 複数の値にマッチ
        1 | 2 => {
            println!("found 1 or 2!");
        }
        // 範囲にマッチ
        3..=9 => {
            println!("found a number 3 to 9 inclusively");
        }
        // マッチした数字を変数に束縛
        matched_num @ 10..=100 => {
            println!("found {} number between 10 to 100!", matched_num);
        }
        // どのパターンにもマッチしない場合のデフォルトマッチが必須
        _ => {
            println!("found something else!");
        }
    }
}
```

**if**
- 同様に値を返せる
- 三項式も使える

```Rust 
fn example() -> i32 {
    let x = 42;
    // Rust の三項式
    let v = if x < 42 { -1 } else { 1 };
    println!("if より: {}", v);
```
- ブロックのスコープは関数のスコープから分離されている
- セミコロンをつけないで書いた式を関数の結果として返すのがRustっぽい書き方
  - セミコロン無しが複数あったら最後の行が返却対象
  - というかコンパイルエラーになる
  - Rustの関数の返り値は基本的に1つだけ。まとめて返したい時は「タプル（tuple）」を使う
  
```Rust
fn example()-> i32{
    let v = {
        let a = 1;
        let b = 2;
        a + b
    };
    // v=3
    println!("ブロックより: {}", v);

    // Rust で関数の最後から値を返す慣用的な方法
    v + 4
}

fn main() {
    // v=7
    println!("関数より: {}", example());
}
```